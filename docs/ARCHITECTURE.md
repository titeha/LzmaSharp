# Architecture

## Цель
Стабильное и быстрое ядро LZMA2 на C# с контролем памяти и возможностью последующих низкоуровневых оптимизаций.

## Слои
- `LzmaCore` — алгоритмы и буферизация (без UI/без платформенных зависимостей)
- `LzmaTests` — корректность/регресс, кросс-проверки с внешними инструментами
- `LzmaBench` — производительность/аллокации/память
- `LzmaCli` — ручные прогоны

## API-подход
- Основной сценарий: `Stream -> Stream`
- Позже: перегрузки с `Span<T>` / `IBufferWriter<byte>` для минимизации копирований
- Пулы: `ArrayPool<byte>` для больших временных буферов

## Проверка корректности
- “7z compress → мы decompress → bytes equal”
- “мы compress → 7z decompress → bytes equal”
- Фиксированный набор тестовых файлов + случайные данные

## Производительность
- Сначала: алгоритмические оптимизации и данные
- Затем: SIMD/Intrinsics/unsafe
- Потом: FASM только на узких местах (memcmp/CRC/копирование/сравнение)
